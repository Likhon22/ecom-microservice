_format_version: "3.0"
_transform: true
services:
  - name: auth-service
    url: grpc://host.docker.internal:5002
    routes:
      - name: create-user-route
        paths: [/users]
        methods: [POST]
        plugins: # Route-specific plugin
          - name: request-transformer
            config:
              add:
                headers:
                  - "grpc-metadata-authorization:$(headers.authorization)"

      - name: login-route
        paths: [/auth/login]
        methods: [POST]
        plugins:
          - name: grpc-cookie-transformer

    plugins: # Service-level plugins (apply to ALL routes)
      - name: grpc-gateway
        config:
          proto: "/kong/protos/auth.proto"
